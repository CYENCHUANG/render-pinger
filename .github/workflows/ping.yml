name: Scheduled Ping

on:
  schedule:
    - cron: '*/10 * * * *'  # æ¯ 10 åˆ†é˜åŸ·è¡Œä¸€æ¬¡

jobs:
  ping-job:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render App
        run: |
          echo "=== Ping Started at $(date) ==="

          RESPONSE=$(curl -s -w "\nHTTP_STATUS:%{http_code}" https://linebot-openai-kysy.onrender.com/ping)

          # åˆ†é›¢å›æ‡‰å…§å®¹èˆ‡ HTTP ç‹€æ…‹ç¢¼
          BODY=$(echo "$RESPONSE" | sed '$d')
          STATUS_CODE=$(echo "$RESPONSE" | tail -n1 | cut -d':' -f2)

          echo "ğŸ”„ Response Body:"
          echo "$BODY"
          echo "ğŸŒ HTTP Status Code: $STATUS_CODE"

          if [ "$STATUS_CODE" -eq 200 ]; then
            echo "âœ… Ping successful."
          else
            echo "âŒ Ping failed. Status code: $STATUS_CODE"
            echo "Timestamp: $(date)"
          fi
